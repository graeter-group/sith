<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sith.readers.g09_reader &mdash; sith</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=8d563738"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script type="module" src="https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs"></script>
        <script type="module" src="https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs"></script>
        <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";import elkLayouts from "https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs";mermaid.registerLayoutLoaders(elkLayouts);mermaid.initialize({startOnLoad:false});</script>
        <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
        <script type="module">
import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";
window.addEventListener("load", () => mermaid.run());
</script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #3434348D" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/favicon.ico" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../workflow/workflow.html">Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/sith.html">sith package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/tutorials.html">Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #3434348D" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">sith</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">sith.readers.g09_reader</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for sith.readers.g09_reader</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">ase</span> <span class="kn">import</span> <span class="n">Atoms</span>
<span class="kn">from</span> <span class="nn">ase.units</span> <span class="kn">import</span> <span class="n">Bohr</span>
<span class="kn">from</span> <span class="nn">ase.data</span> <span class="kn">import</span> <span class="n">chemical_symbols</span>
<span class="kn">from</span> <span class="nn">sith.Utilities</span> <span class="kn">import</span> <span class="n">Geometry</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>


<div class="viewcode-block" id="FileReader">
<a class="viewcode-back" href="../../../modules/sith.readers.html#sith.readers.g09_reader.FileReader">[docs]</a>
<span class="k">class</span> <span class="nc">FileReader</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Object used to read info in a .fchk file and store it into a</span>
<span class="sd">    :mod:`~sith.Utilities.Geometry` object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    path: Path or str</span>
<span class="sd">        Path to the fchk file to extract into a</span>
<span class="sd">        :mod:`~sith.Utilities.Geometry` object.</span>
<span class="sd">    extract_data: bool. Default=True</span>
<span class="sd">        Automatically try to extract the data from the .fchk file. If</span>
<span class="sd">        False, the user should run</span>
<span class="sd">        :mod:`~sith.readers.g09_reader.FileReader._extract`. Defatult=True</span>

<span class="sd">    Attributes</span>
<span class="sd">    ==========</span>
<span class="sd">    dims: np.array</span>
<span class="sd">        counter of the DOFs, organized as:</span>
<span class="sd">        [0] Total number of DOFs</span>
<span class="sd">        [1] Number of distances</span>
<span class="sd">        [2] Number of angles</span>
<span class="sd">        [3] Number of dihedrals</span>
<span class="sd">    geometry: sith.Utilities.Geometry</span>
<span class="sd">        object where the info is stored.</span>
<span class="sd">    block_readers: dict</span>
<span class="sd">        dictionary with the header and the respective reader that stores the</span>
<span class="sd">        values in :mod:`~sith.Utilities.Geometry`.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    This class should be used only for developers. Use this as a template to</span>
<span class="sd">    create other readers. Readers should assign the values to the attributes of</span>
<span class="sd">    the class :mod:`~sith.Utilities.Geometry`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">extract_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="p">(</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">stem</span>

        <span class="c1"># Geometry object into which the Extractor loads the extracted fchk</span>
        <span class="c1"># data:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span> <span class="o">=</span> <span class="n">Geometry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">ref_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># dims of DOFS [#DOFS, #lenghts, #angles, #dihedrals]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dims</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Read lines in file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__lines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="k">as</span> <span class="n">dFile</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">dFile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;One or more gaussian fchk files are empty.&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__lines</span> <span class="o">=</span> <span class="n">lines</span>

        <span class="c1"># False mainly for debug and tests</span>
        <span class="k">if</span> <span class="n">extract_data</span><span class="p">:</span>
            <span class="c1"># Add info to geometry object</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_extract</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_extract</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extracts and populates Geometry information from self.__lines</span>

<span class="sd">        Return</span>
<span class="sd">        ======</span>
<span class="sd">        (bool) True if extracting data is successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#  headers in fchk files from g09</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__energy_header</span> <span class="o">=</span> <span class="s2">&quot;Total Energy&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__hessian_header</span> <span class="o">=</span> <span class="s2">&quot;Internal Force Constants&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__coords_header</span> <span class="o">=</span> <span class="s2">&quot;Current cartesian coordinates&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__DOF_header</span> <span class="o">=</span> <span class="s2">&quot;Redundant internal coordinates&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__DOF_dim_header</span> <span class="o">=</span> <span class="s2">&quot;Redundant internal dimensions&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__DOF_indices_header</span> <span class="o">=</span> <span class="s2">&quot;Redundant internal coordinate indices&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__atomic_nums_header</span> <span class="o">=</span> <span class="s2">&quot;Atomic numbers&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__internal_forces</span> <span class="o">=</span> <span class="s2">&quot;Internal Forces&quot;</span>

        <span class="c1"># The next dict contains the headers of the blocks. The corresponding</span>
        <span class="c1"># values are the methods to read each block. all of them has the</span>
        <span class="c1"># current line as a parameter.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">block_readers</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">__atomic_nums_header</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_anum_reader</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">__coords_header</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apos_reader</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">__DOF_dim_header</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dim_reader</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">__DOF_indices_header</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indices_reader</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">__DOF_header</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dof_values_reader</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">__energy_header</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scf_energy_reader</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">__internal_forces</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iforces_reader</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">__hessian_header</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hessian_reader</span><span class="p">}</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># counter of lines</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__lines</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_readers</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">block</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__lines</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                    <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_readers</span><span class="p">[</span><span class="n">block</span><span class="p">](</span><span class="n">i</span><span class="p">)</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_readers</span><span class="p">[</span><span class="n">block</span><span class="p">]</span>
                    <span class="k">break</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">build_atoms</span><span class="p">()</span>

        <span class="k">return</span> <span class="kc">True</span>

<div class="viewcode-block" id="FileReader.build_atoms">
<a class="viewcode-back" href="../../../modules/sith.readers.html#sith.readers.g09_reader.FileReader.build_atoms">[docs]</a>
    <span class="k">def</span> <span class="nf">build_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Atoms</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a ase.Atoms object of the structure in the fchk file.</span>

<span class="sd">        Return</span>
<span class="sd">        ======</span>
<span class="sd">        (ase.Atoms) Atoms object with the molecular information of the</span>
<span class="sd">        structure.</span>

<span class="sd">        Note: Before using this method, FileReader.cartesian_coordinates and</span>
<span class="sd">        FileReader.atomic_nums must have an assigned value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_coord</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Cartesian coordinates &quot;</span> <span class="o">+</span>\
            <span class="s2">&quot;were not read properly&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomic_nums</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Atomic numbers were not read &quot;</span> <span class="o">+</span>\
            <span class="s2">&quot; properly&quot;</span>
        <span class="n">atomic_coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_coord</span>
        <span class="n">molecule</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">chemical_symbols</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomic_nums</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">Atoms</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">atomic_coord</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">atoms</span></div>


    <span class="c1"># region readers</span>
    <span class="k">def</span> <span class="nf">_fill_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ith_line</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fill an array after a given header line of a g09 block.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        ith_line: int</span>
<span class="sd">            Index of the line where the header of the block is.</span>
<span class="sd">        dtype: data-type. Default=numpy default value.</span>
<span class="sd">            The desired data-type for the array. Default= Numpy guess.</span>

<span class="sd">        Return</span>
<span class="sd">        ======</span>
<span class="sd">        (np.array, int) read data, the jth-line where the data</span>
<span class="sd">        finished in the file.</span>

<span class="sd">        Note: This method is useful because all the arrays in fchk files</span>
<span class="sd">        starts with a title and the numbers of elements in the end of the line.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># reads the number of elements</span>
        <span class="n">len_list</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__lines</span><span class="p">[</span><span class="n">ith_line</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">filling_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">filling_list</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">len_list</span><span class="p">:</span>
            <span class="n">ith_line</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">filling_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__lines</span><span class="p">[</span><span class="n">ith_line</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">filling_list</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">),</span> <span class="n">ith_line</span>

    <span class="k">def</span> <span class="nf">_anum_reader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ith_line</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read the atomic numbers</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        ith_line: int</span>
<span class="sd">            line index where atomic numbers header was found.</span>

<span class="sd">        Return</span>
<span class="sd">        ======</span>
<span class="sd">        (int, np.array) index of the last line of the data block in the file,</span>
<span class="sd">        atomic numbers of the molecule with shape (#atoms).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atomic_nums</span><span class="p">,</span> <span class="n">ith_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_array</span><span class="p">(</span><span class="n">ith_line</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">n_atoms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomic_nums</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ith_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomic_nums</span>

    <span class="k">def</span> <span class="nf">_scf_energy_reader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ith_line</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read DFT energy</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        ith_line: int</span>
<span class="sd">            line index where energy header was found.</span>

<span class="sd">        Return</span>
<span class="sd">        ======</span>
<span class="sd">        (int, float) same index line of the header, DFT energy of the structure</span>
<span class="sd">        in Hartrees.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">scf_energy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__lines</span><span class="p">[</span><span class="n">ith_line</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">ith_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">scf_energy</span>

    <span class="k">def</span> <span class="nf">_dim_reader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ith_line</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read DOFs dimensions</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        ith_line: int</span>
<span class="sd">            line index where dimensions header was found.</span>

<span class="sd">        Return</span>
<span class="sd">        ======</span>
<span class="sd">        (int, np.array) index of the last line of the data block in the file,</span>
<span class="sd">        dimensions given as [#DOFS, #lenghts, #angles, #dihedrals].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ith_line</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">dims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__lines</span><span class="p">[</span><span class="n">ith_line</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid input given for Redundant &quot;</span>
                            <span class="o">+</span> <span class="s2">&quot;internal dimensions.&quot;</span><span class="p">)</span>

        <span class="k">assert</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dims</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">dims</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">and</span> \
            <span class="nb">len</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">,</span> \
            <span class="s2">&quot;Invalid quantities of dimension types (bond &quot;</span> <span class="o">+</span>\
            <span class="s2">&quot;lengths, angles, dihedrals) given in .fchk.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dims</span> <span class="o">=</span> <span class="n">dims</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">dims</span> <span class="o">=</span> <span class="n">dims</span>

        <span class="k">return</span> <span class="n">ith_line</span><span class="p">,</span> <span class="n">dims</span>

    <span class="k">def</span> <span class="nf">_indices_reader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ith_line</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read DOFs indices</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        ith_line: int</span>
<span class="sd">            line index where indices definition header was found.</span>

<span class="sd">        Return</span>
<span class="sd">        ======</span>
<span class="sd">        (int, np.array) index of the last line of the data block in the file,</span>
<span class="sd">        indices that define each DOF with shape (#DOFs, 4)</span>

<span class="sd">        Note: These indices start in one. Indices zero means None value in</span>
<span class="sd">        this array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r_indices</span><span class="p">,</span> <span class="n">ith_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_array</span><span class="p">(</span><span class="n">ith_line</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;The dimensions were not properly read&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">r_indices</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> \
            <span class="s2">&quot;Missing Redundant internal coordinate indices.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">dim_indices</span> <span class="o">=</span> <span class="n">r_indices</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">ith_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">dim_indices</span>

    <span class="k">def</span> <span class="nf">_dof_values_reader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ith_line</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read DOFs values</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        ith_line: int</span>
<span class="sd">            line index where DOF values header was found.</span>

<span class="sd">        Return</span>
<span class="sd">        ======</span>
<span class="sd">        (int, np.array) index of the last line of the data block in the file,</span>
<span class="sd">        values of the DOFs for the given configuration with shape (#DOFs).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dofs</span><span class="p">,</span> <span class="n">ith_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_array</span><span class="p">(</span><span class="n">ith_line</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">dofs</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;unexpected number of DOFs while &quot;</span> <span class="o">+</span>\
            <span class="s2">&quot;trying to extract DOFs values&quot;</span>
        <span class="n">dofs</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">*=</span> <span class="n">Bohr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">dof</span> <span class="o">=</span> <span class="n">dofs</span>

        <span class="k">return</span> <span class="n">ith_line</span><span class="p">,</span> <span class="n">dofs</span>

    <span class="k">def</span> <span class="nf">_apos_reader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ith_line</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read atomic positions (cartesian coordinates).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        ith_line: int</span>
<span class="sd">            line index where coordinates header was found.</span>

<span class="sd">        Return</span>
<span class="sd">        ======</span>
<span class="sd">        (int, np.array) index of the last line of the data block in the file,</span>
<span class="sd">        atomic coordinates with shape (#atoms, 3).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r_coord</span><span class="p">,</span> <span class="n">ith_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_array</span><span class="p">(</span><span class="n">ith_line</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">r_coord</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">n_atoms</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> \
            <span class="s2">&quot;Missing coordinates components.&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_coord</span> <span class="o">=</span> <span class="n">r_coord</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">n_atoms</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">ith_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cartesian_coord</span>

    <span class="k">def</span> <span class="nf">_hessian_reader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ith_line</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read hessian elements and build the matrix</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        ith_line: int</span>
<span class="sd">            line index where hessian header was found.</span>

<span class="sd">        Return</span>
<span class="sd">        ======</span>
<span class="sd">        (int, np.array) index of the last line of the data block in the file,</span>
<span class="sd">        hessian matrix with shape (#DOFs, #DOFs)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Note: Gaussian stores the lower triangular matrix. This method builds</span>
        <span class="c1"># the complete matrix.</span>

        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;The dimensions were not properly read&quot;</span>

        <span class="n">r_hess</span><span class="p">,</span> <span class="n">ith_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_array</span><span class="p">(</span><span class="n">ith_line</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">r_hess</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> \
            <span class="s2">&quot;Missing Hessian elements.&quot;</span>
        <span class="c1"># Build Hessian matrix</span>
        <span class="n">hessian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
        <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril_indices</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i_elem</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r_hess</span><span class="p">)):</span>
            <span class="n">hessian</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="n">i_elem</span><span class="p">]][</span><span class="n">col</span><span class="p">[</span><span class="n">i_elem</span><span class="p">]]</span> <span class="o">=</span> <span class="n">r_hess</span><span class="p">[</span><span class="n">i_elem</span><span class="p">]</span>
            <span class="c1"># As the hessian is symmetric:</span>
            <span class="n">hessian</span><span class="p">[</span><span class="n">col</span><span class="p">[</span><span class="n">i_elem</span><span class="p">]][</span><span class="n">row</span><span class="p">[</span><span class="n">i_elem</span><span class="p">]]</span> <span class="o">=</span> <span class="n">r_hess</span><span class="p">[</span><span class="n">i_elem</span><span class="p">]</span>

        <span class="c1"># fchk files of g09 store distances in Bohr, so, those DOFs defined as</span>
        <span class="c1"># distances must be transformed</span>
        <span class="n">hessian</span><span class="p">[:,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">/=</span> <span class="n">Bohr</span>
        <span class="n">hessian</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">/=</span> <span class="n">Bohr</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">hessian</span> <span class="o">=</span> <span class="n">hessian</span>

        <span class="k">return</span> <span class="n">ith_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">hessian</span>

    <span class="k">def</span> <span class="nf">_iforces_reader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ith_line</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read internal forces.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        ith_line: int</span>
<span class="sd">            line index where internal forces header was found.</span>

<span class="sd">        Return</span>
<span class="sd">        ======</span>
<span class="sd">        (int, np.array) index of the last line of the data block in the file,</span>
<span class="sd">        generalized forces in DOFs with shape (#DOFs)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">forces</span><span class="p">,</span> <span class="n">ith_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_array</span><span class="p">(</span><span class="n">ith_line</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">forces</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;unexpected number of DOFs &quot;</span> <span class="o">+</span>\
            <span class="s2">&quot;while trying to extract DOFs values&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">internal_forces</span> <span class="o">=</span> <span class="n">forces</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">internal_forces</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">/=</span> <span class="n">Bohr</span>

        <span class="k">return</span> <span class="n">ith_line</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">internal_forces</span></div>

    <span class="c1"># endregion</span>


<div class="viewcode-block" id="G09Reader">
<a class="viewcode-back" href="../../../modules/sith.readers.html#sith.readers.g09_reader.G09Reader">[docs]</a>
<span class="k">class</span> <span class="nc">G09Reader</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tool to read a set of fchk files of g09 corresponding to stretched</span>
<span class="sd">    molecules. It creates the geometries for each stretched configuration.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    inputfiles: list or str</span>
<span class="sd">        list of paths to the fchk files (as strings or paths). The order of</span>
<span class="sd">        the elements matters according to the energy anaylis applied. This</span>
<span class="sd">        parameter could be also a string of the path to the a directory</span>
<span class="sd">        containing the fchk files in alphabetic order.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ==========</span>
<span class="sd">    inputfiles: list[Path]</span>
<span class="sd">        paths to the fchk files.</span>
<span class="sd">    structures: list[Geometry]</span>
<span class="sd">        list of :mod:`sith.Utilities.Geometry`\s for each deformed</span>
<span class="sd">        configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputfiles</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">str</span><span class="p">]):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inputfiles</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">)):</span>
            <span class="n">master_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">inputfiles</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">master_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">(),</span> <span class="s2">&quot;Master directory does not exist.&quot;</span>
            <span class="n">inputfiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">fil</span> <span class="k">for</span> <span class="n">fil</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">master_path</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*.fchk&#39;</span><span class="p">))]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inputfiles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">)):</span>
            <span class="n">inputfiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">fil</span><span class="p">)</span> <span class="k">for</span> <span class="n">fil</span> <span class="ow">in</span> <span class="n">inputfiles</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;input file must be a path or a list of paths to&quot;</span>
                             <span class="s2">&quot; fchk gaussian files&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputfiles</span> <span class="o">=</span> <span class="n">inputfiles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_files</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputfiles</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">structures</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">fil</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputfiles</span><span class="p">:</span>
            <span class="n">read_file</span> <span class="o">=</span> <span class="n">FileReader</span><span class="p">(</span><span class="n">fil</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">read_file</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">files_paths</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check that all files exist.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        files_paths: list[Path]</span>
<span class="sd">            list of paths that you want to check if they exist. It raises an</span>
<span class="sd">            error in case any of the files does not exist.</span>

<span class="sd">        Return</span>
<span class="sd">        ======</span>
<span class="sd">        (bool) True if it works.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: change all prints for logging</span>
        <span class="c1"># print(&quot;Validating input files...&quot;)</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files_paths</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">file</span><span class="o">.</span><span class="n">exists</span><span class="p">(),</span> \
                   <span class="s2">&quot;Path to reference geometry data does not exist.&quot;</span>

        <span class="k">return</span> <span class="kc">True</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Daniel Sucerquia, Mikaela Farrugia.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>